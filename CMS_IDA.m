function [result, period1] = CMS_IDA(Mw,T,Rjb,Fault_Type,region,z1,Vs30,T1,e,k);

% Mw=6;
% Rjb=10
% Fault_Type=0
% region=1
% z1=999
% Vs30=360
% T1=1 %Tcond
% e=1 %
% k=1 % one standard
% 
T=[0.0100000000000000,0.0200000000000000,0.0220000000000000,0.0250000000000000,0.0290000000000000,0.0300000000000000,0.0320000000000000,0.0350000000000000,0.0360000000000000,0.0400000000000000,0.0420000000000000,0.0440000000000000,0.0450000000000000,0.0460000000000000,0.0480000000000000,0.0500000000000000,0.0550000000000000,0.0600000000000000,0.0650000000000000,0.0670000000000000,0.0700000000000000,0.0750000000000000,0.0800000000000000,0.0850000000000000,0.0900000000000000,0.0950000000000000,0.100000000000000,0.110000000000000,0.120000000000000,0.130000000000000,0.133000000000000,0.140000000000000,0.150000000000000,0.160000000000000,0.170000000000000,0.180000000000000,0.190000000000000,0.200000000000000,0.220000000000000,0.240000000000000,0.250000000000000,0.260000000000000,0.280000000000000,0.290000000000000,0.300000000000000,0.320000000000000,0.340000000000000,0.350000000000000,0.360000000000000,0.380000000000000,0.400000000000000,0.420000000000000,0.440000000000000,0.450000000000000,0.460000000000000,0.480000000000000,0.500000000000000,0.550000000000000,0.600000000000000,0.650000000000000,0.667000000000000,0.700000000000000,0.750000000000000,0.800000000000000,0.850000000000000,0.900000000000000,0.950000000000000,1,1.10000000000000,1.20000000000000,1.30000000000000,1.40000000000000,1.50000000000000,1.60000000000000,1.70000000000000,1.80000000000000,1.90000000000000,2,2.20000000000000,2.40000000000000,2.50000000000000,2.60000000000000,2.80000000000000,3,3.20000000000000,3.40000000000000,3.50000000000000,3.60000000000000,3.80000000000000,4,4.20000000000000,4.40000000000000,4.60000000000000,4.80000000000000,5,5.50000000000000,6,6.50000000000000,7,7.50000000000000,8,8.50000000000000,9,9.50000000000000,10];

[median, sigma, period1] = gmpe_bssa_2014(Mw, T, Rjb, Fault_Type, region, z1, Vs30);
nn=length(T);
for i = 1:nn
    rho(i) = baker_jayaram_correlation(T(i), T1); %correlation relationship 如果采用RJK16（最大周期不超2.0s）
end

for i=1:nn
meanReq(i,1)=T(i);
meanReq(i,2) =exp(log(median(i))+sigma(i).*e.*rho(i)); % 单位（gal）
end

for i=1:nn
meanReq(i,3)=exp(log(meanReq(i,2))+k*sigma(i)*sqrt(1-rho(i)^2));
meanReq(i,4)=exp(log(meanReq(i,2))-k*sigma(i)*sqrt(1-rho(i)^2));
end

result=meanReq(:,2);
